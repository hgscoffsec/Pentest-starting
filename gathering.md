<h1> Enumeration </h1>

<h2> Common services</h2>
FTP   : 21 <code>$nmap -script ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -o 21 x.x.x.x</code><br>
SSH   : 22 <code>$ssh x.x.x.x 22</code><br>
Telner: 23 <br>
SMTP  : 25 <br>
<pre><code>$nmap -script smtp-commands,smtp-enum-users,smtp-vuln-cve2010-4344,smtp-vuln-cve2011-1720,smtp-vuln-cve2011-1764 -p 25 x.x.x.x
$nc -nvv x.x.x.x 25
$telnet x.x.x.x 25
</code></pre><br>
DNS   : 53
<pre><code>$nslookup -> set type=any -> ls -d blah.com
$dig axfr blah.com @ns1.blah.com
$dnsrecon -d TARGET -D /usr/share/wordlists/dnsmap.txt -t std --xml ouput.xml</code></pre>
Finger: 79 Using with this <a href="http://pentestmonkey.net/tools/user-enumeration/finger-user-enum">wordlist</a>
Web   : 80/443 
<pre><code>$dirb http://x.x.x.x/
$nikto –h x.x.x.x</code></pre>
POP3  : 110
<code>$telnet x.x.x.x 110
USER [username]
PASS [password]
</code> tologin <br>
<code> LIST</code> to list messages <br>
<code> RETR [message number]</code> retrieve message<br>
<code> QUIT</code> quits<br>
RPCBind : 111 <code>$rpcinfo –p x.x.x.x</code><br>
SMB/RPC : 139/445
<pre><code>$enum4linux –a x.x.x.x</code>
$nbtscan x.x.x.x
$py 192.168.XXX.XXX 500 50000 dict.txt
$python /usr/share/doc/python-impacket-doc/examples/samrdump.py 192.168.XXX.XXX
$nmap IPADDR --script smb-enum-domains.nse,smb-enum-groups.nse,smb-enum-processes.nse,smb-enum-sessions.nse,smb-enum-shares.nse,smb-enum-users.nse,smb-ls.nse,smb-mbenum.nse,smb-os-discovery.nse,smb-print-text.nse,smb-psexec.nse,smb-security-mode.nse,smb-server-stats.nse,smb-system-info.nse,smb-vuln-conficker.nse,smb-vuln-cve2009-3103.nse,smb-vuln-ms06-025.nse,smb-vuln-ms07-029.nse,smb-vuln-ms08-067.nse,smb-vuln-ms10-054.nse,smb-vuln-ms10-061.nse,smb-vuln-regsvc-dos.nse
$smbclient -L x.x.x.x
$smbclient x.x.x.x/ipc$ -U john
</pre></code>
SNMP  : 161
<pre><code>$snmpwalk -c public -v1 x.x.x.x
$snmpcheck -t x.x.x.x -c public
onesixtyone -c names -i hosts
$nmap -sT -p 161 x.x.x.x -oG snmp_results.txt
$snmpenum -t x.x.x.x</pre></code>
Oracle: 1521
<pre><code>$tnscmd10g version -h x.x.x.x
$tnscmd10g status -h x.x.x.x</pre></code>
Mysql : 3306<br>
<code>$nmap -sV -Pn -vv  10.0.0.1 -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122</code

<h2>General Enumeration</h2>
<code>$nmap -vv -Pn -A -sC -sS -T 4 -p- x.x.x.x</code>: Verbose, syn, all ports, all scripts, no ping
<br><code>$nmap -v -sS -A -T4 x.x.x.x</code>: Verbose, SYN Stealth, version info, and script against services
<br><code>$nmap -script smb-check-vulns.nse -script-args=unsafe=1 -p445 x.x.x.x</code>: Nmap scipt to scan for vulnerable SMB servers-WARNING: unsafe=1 may cause knockover
<br><code>$netdiscover -r x.x.x.0/24

<h2>Mount file shares</h2>
<pre><code>$showmount -e IPADDR
$mount 192.168.1.1:/vol/share /mnt/nfs  -nolock
$mount -t cifs -o username=user,password=pass,domain=blah //192.168.1.X/share-name /mnt/cifs
$net use Z: \\win-server\share password  /user:domain\janedoe /savecred /p:no
$apt-get install smb4k –y</pre></code>

<h2>Fingerprinting</h2>
Basic versioning / finger printing via displayed banner
<pre><code>$nc -v 192.168.1.1 25
$telnet 192.168.1.1 25</pre></code>

<h2>Exploit Research</h2>
<code>$searchsploit windows 2003 | grep -i local</code>

<h2>Compiling Exploits</h2>
<pre><code>$gcc -o exploit exploit.c
$i586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe</pre></code>

<h2>Packet Inspection</h2>
<code>$tcpdump tcp port 80 -w output.pcap -i eth0</code>

<h2>Password Cracking</h2>
<pre><code>$hash-identifier [hash]
$john hashes.txt
$hashcat -m 500 -a 0 -o output.txt –remove hashes.txt /usr/share/wordlists/rockyou.txt
$hashcat -m 1000 dump.txt -o output.txt --remove -a 3 ?u?l?l?d?d?d?d
</pre></code>
List of hash types and examples for hashcat https://hashcat.net/wiki/doku.php?id=example_hashes 
<br.https://hashkiller.co.uk has a good repo of already cracked MD5 and NTLM hashes

<h2>Bruteforcing</h2>
<pre><code>$hydra 10.0.0.1 http-post-form “/admin.php:target=auth&mode=login&user=^USER^&password=^PASS^:invalid” -P /usr/share/wordlists/rockyou.txt -l admin
$hydra -l admin -P /usr/share/wordlists/rockyou.txt -o results.txt IPADDR PROTOCOL
$hydra -P /usr/share/wordlistsnmap.lst 192.168.X.XXX smtp –V</pre></code>



